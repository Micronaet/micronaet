<?xml version="1.0"?>
<openerp>
    <data>
        <record model="ir.ui.view" id="view_mrp_production_workcenter_line_tree">
            <field name="name">mrp.production.workcenter.line.tree</field>
            <field name="model">mrp.production.workcenter.line</field>
            <field name="priority" eval="40" />
            <field name="arch" type="xml">
                <tree string="Production log import" colors="red:log_ok==False and (log_error_load==True or log_error_unload==True)">
                    <field name="production_id" />
                    <field name="name" />
                    <field name="date_start" />
                    <field name="hour" />
                    <field name="qty" />

                    <field name="log_account_unload" />
                    <field name="log_error_unload" />
                    <field name="log_filename_unload" />

                    <field name="log_account_load" />
                    <field name="log_error_load" />
                    <field name="log_filename_load" />

                    <field name="log_ok" invisible="1"/>
                    <button name="mark_ok" string="OK seen!" type="object" attrs="{'invisible': [('log_ok','=',True)]}" icon="gtk-ok"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_mrp_production_workcenter_line_form">
            <field name="name">mrp.production.workcenter.line.form</field>
            <field name="model">mrp.production.workcenter.line</field>
            <field name="priority" eval="40" />
            <field name="arch" type="xml">
                <form string="Production log import" version="7.0"> 
                    <header>
                        <button name="mark_ok" string="OK seen!" type="object" icon="gtk-ok" />
                    </header>
                    <sheet> 
                        <group colspan="4" col="4">               
                            <field name="production_id" readonly="1" />
                            <field name="name" readonly="1" />
                            <field name="date_start" readonly="1" />
                            <field name="hour" readonly="1" />
                            <field name="qty" readonly="1" />

                            <field name="log_ok" attrs="{'invisible': [('log_ok','=',True)]}"/>

                            <field name="log_error_unload" readonly="1" />
                            <field name="log_filename_unload" readonly="1" />
                            <field name="log_account_unload" readonly="1" />
                            <field name="log_account_date_unload" readonly="1" />
                            <separator string="Log detail unload" colspan="4"/>
                            <field name="log_detail_unload" colspan="4" nolabel="1" readonly="1" />
                            <separator string="Log error unload" colspan="4"/>
                            <field name="log_error_text_unload" colspan="4" nolabel="1" readonly="1" />

                            <field name="log_error_load" readonly="1" />
                            <field name="log_filename_load" readonly="1" />
                            <field name="log_account_load" readonly="1" />
                            <field name="log_account_date_load" readonly="1" />
                            <separator string="Log detail load" colspan="4"/>
                            <field name="log_detail_load" colspan="4" nolabel="1" readonly="1"/>
                            <separator string="Log error load" colspan="4"/>
                            <field name="log_error_text_load" colspan="4" nolabel="1" readonly="1" />
                        </group>
                    </sheet>    
                </form>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_mrp_production_workcenter_line_error">
            <field name="name">MRP production log error</field>
            <field name="res_model">mrp.production.workcenter.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_mrp_production_workcenter_line_tree"/>
            <field name="context">{'form_view_ref': 'production_line_mx.view_mrp_production_workcenter_line_form'}</field>
            <field name="domain">[('log_ok', '=', False), '|', ('log_error_load', '=', True), ('log_error_unload', '=', True)]</field>
        </record>
        <record model="ir.actions.act_window" id="action_mrp_production_workcenter_line">
            <field name="name">MRP production log</field>
            <field name="res_model">mrp.production.workcenter.line</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_mrp_production_workcenter_line_tree"/>
            <field name="context">{'form_view_ref': 'production_line_mx.view_mrp_production_workcenter_line_form'}</field>
            <field name="domain">[]</field>
        </record>
        <menuitem 
            parent="mrp.menu_mrp_manufacturing" 
            id="menu_mrp_production_workcenter_line_error" 
            action="action_mrp_production_workcenter_line_error"
            sequence="0"
            />
            <menuitem 
                parent="menu_mrp_production_workcenter_line_error"
                id="menu_mrp_production_workcenter_line"
                action="action_mrp_production_workcenter_line"
                sequence="10"
                />
        
        <!--<record model="ir.ui.view" id="view_product_material_pedimento_form">
            <field name="name">Material Pedimento</field>
            <field name="model">mrp.production.workcenter.line</field>
            <field name="inherit_id" ref="production_line.default_mrp_production_workcenter_line_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='bom_material_ids']/tree/field[@name='product_id']" position="after">
                    <field name="pedimento_id"  domain="[('product_id', '=', product_id)]" options="{'create': false, 'create_edit': false}"/>
                </xpath>
            </field>
        </record>-->

        <record model="ir.ui.view" id="view_product_product_waste_tree">
            <field name="name">product.product.tree</field>
            <field name="model">product.product</field>
            <field name="priority" eval="40" />
            <field name="arch" type="xml">
                <tree string="Product" editable="bottom" colors="blue:waste_id!=False">        
                    <field name="name" readonly="1"/>
                    <field name="default_code" readonly="1" />
                    <field name="standard_price" readonly="1" />
                    <field name="forced_price" />
                    <field name="waste_id" />
                    <field name="product_type" />
                    <!--<button name="get_waste_product" string="Auto" type="object" attrs="{'invisible': [('waste_id','!=',False)]}" />-->
                </tree>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_product_product_waste">
            <field name="name">Waste product</field>
            <field name="res_model">product.product</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_product_product_waste_tree"/>
            <field name="context">{}</field>
            <field name="domain">[]</field>
        </record>
        <menuitem 
            parent="mrp.menu_mrp_bom" 
            id="menu_action_product_product_waste"
            action="action_product_product_waste"
            />
        
        <record model="ir.ui.view" id="default_mrp_production_workcenter_line_pedimento_view">
            <field name="name">Lavoration default</field>
            <field name="model">mrp.production.workcenter.line</field>
            <field name="inherit_id" ref="production_line.default_mrp_production_workcenter_line_view" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='bom_material_ids']/tree/field[@name='product_id']" position="after">
                    <field name="standard_price" />
                    <field name="pedimento_id" domain="[('product_id', '=', product_id)]" options="{'create': false, 'create_edit': false}"/>
                    <field name="pedimento_price" />
                </xpath>
            </field>
        </record>    

        <record model="ir.ui.view" id="default_mrp_production_form_view">
            <field name="name">Production default</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="production_line.default_mrp_production_form_view" />
            <field name="arch" type="xml">
                <xpath expr="//notebook" position="after">
                    <separator string="Check MRP error:" colspan="4" attrs="{'invisible': [('check_mrp','=',False)]}"/>
                    <field name="check_mrp" nolabel="1" colspan="4" attrs="{'invisible': [('check_mrp','=',False)]}"/>
                </xpath>
                
                <xpath expr="//field[@name='bom_material_ids']/tree/field[@name='product_id']" position="after">
                    <field name="standard_price" />
                    <field name="pedimento_id" domain="[('product_id', '=', product_id)]" options="{'create': false, 'create_edit': false}"/>
                    <field name="pedimento_price" />
                </xpath>

                <!--Pedimento check:-->
                <xpath expr="//field[@name='bom_material_ids']/tree/field[@name='accounting_qty']" position="after">
                    <field name="pedimento_covered" invisible="1"/>
                    <button name="manage_pedimento_error" string="Pedimento not covered" icon="STOCK_DIALOG_WARNING" type="object" 
                        confirm="Do you want to duplicate line and create a new line for remain qty?" 
                        attrs="{'invisible': [('pedimento_covered','=',True)]}"/>

                    <field name="accounting_covered" invisible="1" />
                    <button name="dummy_button" string="Waste not covered change qrt!" icon="gtk-stop" type="object" 
                        attrs="{'invisible': [('accounting_covered','=',True)]}"/>
                </xpath>
                <xpath expr="//field[@name='bom_material_ids']/tree" position="attributes">
                    <attribute name="colors">red:pedimento_id==False or pedimento_covered==False</attribute>
                </xpath>

                <!--Waste check:-->
                <xpath expr="//field[@name='bom_waste_ids']/tree/field[@name='accounting_qty']" position="after">
                    <field name="accounting_covered" invisible="1" />
                    <button name="dummy_button" string="Waste not covered change qrt!" icon="gtk-stop" type="object" 
                        attrs="{'invisible': [('accounting_covered','=',True)]}"/>
                </xpath>
                <xpath expr="//field[@name='bom_waste_ids']/tree" position="attributes">
                    <attribute name="colors">red:accounting_covered==False</attribute>
                </xpath>
            </field>
        </record>    

        <!--mrp.production.material-->
        <record model="ir.ui.view" id="view_mrp_production_material_pedimento_tree">
            <field name="name">Production material</field>
            <field name="model">mrp.production.material</field>
            <field name="inherit_id" ref="production_line.view_mrp_production_material_tree"/>
            <field name="arch" type="xml">
                   <field name='product_id' position="after">
                       <field name="standard_price" />
                       <field name="pedimento_id" domain="[('product_id', '=', product_id)]" options="{'create': false, 'create_edit': false}"/>
                       <field name="pedimento_price" />
                   </field>    
            </field>
        </record>    
        <record model="ir.ui.view" id="view_mrp_production_material_pedimento_form">
            <field name="name">Production material</field>
            <field name="model">mrp.production.material</field>
            <field name="inherit_id" ref="production_line.view_mrp_production_material_form" />
            <field name="arch" type="xml">
               <field name='product_id' position="after" >
                    <field name="standard_price" />
                    <field name="pedimento_id" domain="[('product_id', '=', product_id)]" options="{'create': false, 'create_edit': false}"/>
                    <field name="pedimento_price" />
               </field>    
            </field>
        </record>    
        
        <record model="ir.ui.view" id="view_product_uom_ref_form">
            <field name="name">product.uom.form</field>
            <field name="model">product.uom</field>
            <field name="inherit_id" ref="product.product_uom_form_view"/>
            <field name="arch" type="xml">
                <field name="rounding" position="after">
                    <field name="contipaq_ref" />
                </field>
            </field>
        </record>
        <record model="ir.ui.view" id="view_product_uom_ref_tree">
            <field name="name">product.uom.tree</field>
            <field name="model">product.uom</field>
            <field name="inherit_id" ref="product.product_uom_tree_view"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="contipaq_ref" />
                </field>
            </field>
        </record>
        <record model="ir.ui.view" id="view_mrp_extra_Data_form">
            <field name="name">mrp.production.form</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
            <field name="arch" type="xml">
                <field name="user_id" position="after">
                    <field name="accounting_sl_code" readonly="1" invisible="1"/>
                    <field name="accounting_cl_code" readonly="1" invisible="1"/>
                </field>
                <field name="date_planned" position="after">
                    <field name="force_production_rate" />
                </field>
            </field>
        </record>

        <record model="ir.ui.view" id="default_mrp_production_workcenter_line_calc_view">
            <field name="name">Lavoration default calc</field>
            <field name="model">mrp.production.workcenter.line</field>
            <field name="inherit_id" ref="production_line.default_mrp_production_workcenter_line_view" />
            <field name="arch" type="xml">
                <page string="Load" position="after">
                    <page string="Load calc" attrs="{'invisible': [('product_price_calc','=',False)]}">
                        <separator string="Calculation:" colspan="4" />
                        <field name="product_price_calc" widget="html" colspan="4" nolabel="1" />
                    </page>
                </page>                    
            </field>
        </record>        
        
        <record model="ir.ui.menu" id="production_line.menu_base_production_root_production">
            <!--<field name="active" eval="False"/>-->
            <field name="groups_id" eval="[(6, 0, [ref('group_hide_menu')])]"/>
        </record>
    </data>
</openerp>

